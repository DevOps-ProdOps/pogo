YUI.add("pogo-view-multidatatable",function(a){a.namespace("Pogo.View").MultiDatatable=new a.Base.create("pogo-view-multidatatable",a.View,[],{setupPaginator:function(b){var c=new a.Paginator({itemsPerPage:this.get("limit"),totalItems:5,page:this.get("offset")});c.render(b);return c;},setupDatatable:function(b,j,f){var g,d,c,e,h,k,i;if(a.Lang.isString(b)){k=this.get("container").one("."+b);i=this.get("container").one("."+b+"-pg");}c=this.parameterMixIn(f);c=this.limitMixIn(c);g=new a.Pogo.Model.JobsList({params:c});d=new a.DataTable({columns:j});d.render(k);d.set("message","Loading...");h=this.setupPaginator(i);e=function(m){var n=(h.get("page")-1)*h.get("itemsPerPage"),l=n+h.get("itemsPerPage");d.set("data",g._items.slice(n,l));};h.after("pageChange",e,this);g.after("load",e,this);g.load(function(l,m){if(l){alert("Could not load data:\n"+l);d.set("message","Error when loading data.");h.set("totalItems",m.meta.count||5);}});},setupDatatables:function(){var c=this.get("dtCols"),b=this.get("tables");a.each(b,function(d){this.setupDatatable(d.className,c,d.params);},this);},template:"<h1>{title}</h1>",render:function(){var h,g,b=this.get("container"),c=this.get("tables"),e={children:[]},f,d='<div class="{className}"></div><div class="{className}-pg"></div>';a.each(c,function(j){var i={label:j.label,content:a.Lang.sub(d,{className:j.className})};e.children.push(i);},this);f=new a.TabView(e);b.addClass("pogo-datatablegroup");b.setContent(a.Lang.sub(this.template,{title:this.get("title")}));f.onceAfter("render",this.setupDatatables,this);f.render(b);return this;},parameterMixIn:function(b){return b;},limitMixIn:function(e){var b=this.get("limit"),d=this.get("offset"),c={max:b};if(d){c.offset=d;}return a.mix(e,c);}},{ATTRS:{title:{value:"Pogo Jobs"},limit:{value:25},offset:{value:1},dtCols:{value:[{key:"jobid",label:"Pogo ID",nodeFormatter:a.Pogo.Formatters.idFormatter},{key:"user",label:"User",nodeFormatter:a.Pogo.Formatters.userFormatter},{key:"state",label:"State"},{key:"start_time",label:"Start Time",formatter:a.Pogo.Formatters.timeFormatter},{key:"command",label:"Command",nodeFormatter:a.Pogo.Formatters.commandFormatter},{key:"range",label:"Targets",nodeFormatter:a.Pogo.Formatters.targetFormatter},{key:"host_count",label:"Hosts"}]},tables:{value:[{label:"Active",className:"dt-active",params:{active:1}},{label:"All",className:"dt-all",params:{}}]}}});},"@VERSION@",{requires:["base","view","datatable","pogo-model-jobslist","tabview","pogo-formatters","gallery-paginator-dev-preview"]});